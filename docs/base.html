<!DOCTYPE html><html><head><title>Mocha - API documentation</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="stylesheet" href="style.css"><script src="jquery.js"></script><script src="docs.js"></script></head><body><div id="content"><h1>Mocha</h1><div id="isatty" class="comment"><h2>isatty</h2><div class="description"><p>Check if both stdio streams are associated with a tty.</p></div><h3>Source</h3><pre><code>var isatty = tty.isatty(1) && tty.isatty(2);</code></pre></div><div id="exports.useColors" class="comment"><h2>exports.useColors</h2><div class="description"><p>Enable coloring by default.</p></div><h3>Source</h3><pre><code>exports.useColors = isatty;</code></pre></div><div id="exports.colors" class="comment"><h2>exports.colors</h2><div class="description"><p>Default color map.</p></div><h3>Source</h3><pre><code>exports.colors = {
    'pass': 90
  , 'fail': 31
  , 'bright pass': 92
  , 'bright fail': 91
  , 'bright yellow': 93
  , 'pending': 36
  , 'suite': 0
  , 'error title': 0
  , 'error message': 31
  , 'error stack': 90
  , 'checkmark': 32
  , 'fast': 90
  , 'medium': 33
  , 'slow': 31
  , 'green': 32
  , 'light': 90
};</code></pre></div><div id="color" class="comment"><h2>color</h2><div class="description"><p>Color <code>str</code> with the given <code>type</code>,<br />allowing colors to be disabled,<br />as well as user-defined color<br />schemes.</p></div><h3>Source</h3><pre><code>var color = exports.color = function(type, str) {
  if (!exports.useColors) return str;
  return '\033[' + exports.colors[type] + 'm' + str + '\033[0m';
};</code></pre></div><div id="exports.window" class="comment"><h2>exports.window</h2><div class="description"><p>Expose term window size, with some<br />defaults for when stderr is not a tty.</p></div><h3>Source</h3><pre><code>exports.window = {
  width: isatty
    ? process.stdout.getWindowSize
      ? process.stdout.getWindowSize(1)[0]
      : tty.getWindowSize()[1]
    : 75
};</code></pre></div><div id="exports.cursor" class="comment"><h2>exports.cursor</h2><div class="description"><p>Expose some basic cursor interactions<br />that are common among reporters.</p></div><h3>Source</h3><pre><code>exports.cursor = {
  hide: function(){
    process.stdout.write('\033[?25l');
  },

  show: function(){
    process.stdout.write('\033[?25h');
  },

  deleteLine: function(){
    process.stdout.write('\033[2K');
  },

  beginningOfLine: function(){
    process.stdout.write('\033[0G');
  },

  CR: function(){
    exports.cursor.deleteLine();
    exports.cursor.beginningOfLine();
  }
};</code></pre></div><div id="exports.slow" class="comment"><h2>exports.slow</h2><div class="description"><p>A test is considered slow if it<br />exceeds the following value in milliseconds.</p></div><h3>Source</h3><pre><code>exports.slow = 75;</code></pre></div><div id="exports.list" class="comment"><h2>exports.list()</h2><div class="description"><p>Outut the given <code>failures</code> as a list.</p></div><h3>Source</h3><pre><code>exports.list = function(failures){
  console.error();
  failures.forEach(function(test, i){
    // format
    var fmt = color('error title', '  %s) %s:\n')
      + color('error message', '     %s')
      + color('error stack', '\n%s\n');

    // msg
    var err = test.err
      , message = err.message || ''
      , stack = err.stack || message
      , index = stack.indexOf(message) + message.length
      , msg = stack.slice(0, index);

    // indent stack trace without msg
    stack = stack.slice(index + 1)
      .replace(/^/gm, '  ');

    console.error(fmt, (i + 1), test.fullTitle(), msg, stack);
  });
};</code></pre></div><div id="Base" class="comment"><h2>Base()</h2><div class="description"><p>Initialize a new <code>Base</code> reporter.</p>

<p>All other reporters generally<br />inherit from this reporter, providing<br />stats such as test duration, number<br />of tests passed / failed etc.</p></div><h3>Source</h3><pre><code>function Base(runner) {
  var self = this
    , stats = this.stats = { suites: 0, tests: 0, passes: 0, failures: 0 }
    , failures = this.failures = [];

  if (!runner) return;
  this.runner = runner;

  runner.on('start', function(){
    stats.start = new Date;
  });

  runner.on('suite', function(suite){
    stats.suites = stats.suites || 0;
    suite.root || stats.suites++;
  });

  runner.on('test end', function(test){
    stats.tests = stats.tests || 0;
    stats.tests++;
  });

  runner.on('pass', function(test){
    stats.passes = stats.passes || 0;

    var medium = exports.slow / 2;
    test.speed = test.duration > exports.slow
      ? 'slow'
      : test.duration > medium
        ? 'medium'
        : 'fast';

    stats.passes++;
  });

  runner.on('fail', function(test, err){
    stats.failures = stats.failures || 0;
    stats.failures++;
    test.err = err;
    failures.push(test);
  });

  runner.on('end', function(){
    stats.end = new Date;
    stats.duration = new Date - stats.start;
  });
}</code></pre></div><div id="Base.prototype.epilogue" class="comment"><h2>Base#epilogue()</h2><div class="description"><p>Output common epilogue used by many of<br />the bundled reporters.</p></div><h3>Source</h3><pre><code>Base.prototype.epilogue = function(){
  var stats = this.stats
    , fmt;

  console.log();

  // failure
  if (stats.failures) {
    fmt = color('bright fail', '  ✖')
      + color('fail', ' %d of %d tests failed')
      + color('light', ':')

    console.error(fmt, stats.failures, this.runner.total);
    Base.list(this.failures);
    console.error();
    return;
  }

  // pass
  fmt = color('bright pass', '  ✔')
    + color('green', ' %d tests complete')
    + color('light', ' (%dms)');

  console.log(fmt, stats.tests || 0, stats.duration);
  console.log();
};</code></pre></div></div><ul id="menu"><li><a href="#isatty">isatty</a></li><li><a href="#exports.useColors">exports.useColors</a></li><li><a href="#exports.colors">exports.colors</a></li><li><a href="#color">color</a></li><li><a href="#exports.window">exports.window</a></li><li><a href="#exports.cursor">exports.cursor</a></li><li><a href="#exports.slow">exports.slow</a></li><li><a href="#exports.list">exports.list()</a></li><li><a href="#Base">Base()</a></li><li><a href="#Base.prototype.epilogue">Base#epilogue()</a></li></ul></body></html>