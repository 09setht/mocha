<!DOCTYPE html><html><head><title>Mocha - API documentation</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><link rel="stylesheet" href="style.css"><script src="jquery.js"></script><script src="docs.js"></script></head><body><div id="content"><h1>Mocha</h1><div id="module.exports" class="comment"><h2>module.exports</h2><div class="description"><p>Expose <code>Runnable</code>.</p></div><h3>Source</h3><pre><code>module.exports = Runnable;</code></pre></div><div id="Runnable" class="comment"><h2>Runnable()</h2><div class="description"><p>Initialize a new <code>Runnable</code> with the given <code>title</code> and callback <code>fn</code>.</p></div><h3>Source</h3><pre><code>function Runnable(title, fn) {
  this.title = title;
  this.fn = fn;
  this.async = fn && fn.length;
  this.sync = ! this.async;
  this._timeout = 2000;
  this.timedOut = false;
}</code></pre></div><div id="Runnable.prototype.timeout" class="comment"><h2>Runnable#timeout()</h2><div class="description"><p>Set &amp; get timeout <code>ms</code>.</p></div><h3>Source</h3><pre><code>Runnable.prototype.timeout = function(ms){
  if (0 == arguments.length) return this._timeout;
  debug('timeout %d', ms);
  this._timeout = ms;
  if (this.timer) this.resetTimeout();
  return this;
};</code></pre></div><div id="Runnable.prototype.fullTitle" class="comment"><h2>Runnable#fullTitle()</h2><div class="description"><p>Return the full title generated by recursively<br />concatenating the parent's full title.</p></div><h3>Source</h3><pre><code>Runnable.prototype.fullTitle = function(){
  return this.parent.fullTitle() + ' ' + this.title;
};</code></pre></div><div id="Runnable.prototype.clearTimeout" class="comment"><h2>Runnable#clearTimeout()</h2><div class="description"><p>Clear the timeout.</p></div><h3>Source</h3><pre><code>Runnable.prototype.clearTimeout = function(){
  clearTimeout(this.timer);
};</code></pre></div><div id="Runnable.prototype.resetTimeout" class="comment"><h2>Runnable#resetTimeout()</h2><div class="description"><p>Reset the timeout.</p></div><h3>Source</h3><pre><code>Runnable.prototype.resetTimeout = function(){
  var self = this
    , ms = this.timeout();

  this.clearTimeout();
  if (ms) {
    this.timer = setTimeout(function(){
      self.callback(new Error('timeout of ' + ms + 'ms exceeded'));
      self.timedOut = true;
    }, ms);
  }
};</code></pre></div><div id="Runnable.prototype.run" class="comment"><h2>Runnable#run()</h2><div class="description"><p>Run the test and invoke <code>fn(err)</code>.</p></div><h3>Source</h3><pre><code>Runnable.prototype.run = function(fn){
  var self = this
    , ms = this.timeout()
    , start = new Date
    , ctx = this.ctx
    , finished
    , emitted;

  // timeout
  if (this.async) {
    if (ms) {
      this.timer = setTimeout(function(){
        done(new Error('timeout of ' + ms + 'ms exceeded'));
        self.timedOut = true;
      }, ms);
    }
  }

  // called multiple times
  function multiple() {
    if (emitted) return;
    emitted = true;
    self.emit('error', new Error('done() called multiple times'));
  }

  // finished
  function done(err) {
    if (self.timedOut) return;
    if (finished) return multiple();
    self.clearTimeout();
    self.duration = new Date - start;
    finished = true;
    fn(err);
  }

  // for .resetTimeout()
  this.callback = done;

  // async
  if (this.async) {
    try {
      this.fn.call(ctx, function(err){
        if (err instanceof Error) return done(err);
        if (null != err) return done(new Error('done() invoked with non-Error: ' + err));
        done();
      });
    } catch (err) {
      done(err);
    }
    return;
  }
  
  // sync
  try {
    if (!this.pending) this.fn.call(ctx);
    this.duration = new Date - start;
    fn();
  } catch (err) {
    fn(err);
  }
};</code></pre></div></div><ul id="menu"><li><a href="#module.exports">module.exports</a></li><li><a href="#Runnable">Runnable()</a></li><li><a href="#Runnable.prototype.timeout">Runnable#timeout()</a></li><li><a href="#Runnable.prototype.fullTitle">Runnable#fullTitle()</a></li><li><a href="#Runnable.prototype.clearTimeout">Runnable#clearTimeout()</a></li><li><a href="#Runnable.prototype.resetTimeout">Runnable#resetTimeout()</a></li><li><a href="#Runnable.prototype.run">Runnable#run()</a></li></ul></body></html>